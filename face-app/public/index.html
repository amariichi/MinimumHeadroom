<!doctype html>
<html lang="ja">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Minimum Headroom Face</title>
    <link rel="stylesheet" href="/styles.css" />
  </head>
  <body>
    <main class="stage" id="stage">
      <canvas id="face-canvas" aria-label="Minimum Headroom face canvas"></canvas>

      <section class="panel panel-left" aria-live="polite">
        <h1 class="panel-title">minimum headroom</h1>
        <p class="panel-subtitle">tts + freshness + lip sync</p>
        <p class="shortcut-hint">shortcut: Esc / double tap / double click toggles UI panels</p>
        <dl class="metrics">
          <div>
            <dt>ws</dt>
            <dd id="ws-status">connecting</dd>
          </div>
          <div>
            <dt>render mode</dt>
            <dd id="render-mode">monitor</dd>
          </div>
          <div>
            <dt>lg polyfill</dt>
            <dd id="lg-status">loading</dd>
          </div>
          <div>
            <dt>tts</dt>
            <dd id="tts-status">starting</dd>
          </div>
          <div>
            <dt>tts phase</dt>
            <dd id="tts-phase">-</dd>
          </div>
          <div>
            <dt>session</dt>
            <dd id="session-id">-</dd>
          </div>
          <div>
            <dt>viewport</dt>
            <dd id="viewport-size">-</dd>
          </div>
          <div>
            <dt>anchors</dt>
            <dd id="anchor-status">-</dd>
          </div>
        </dl>

        <div class="xr-settings">
          <label>
            <input id="lg-enabled" type="checkbox" />
            looking glass webxr polyfill
          </label>
          <button id="lg-apply" type="button">apply + reload</button>
        </div>

        <div id="xr-button-slot" class="xr-button-slot"></div>

        <pre id="state-values" class="mono-box"></pre>
      </section>

      <section class="panel panel-right">
        <h2 class="panel-title-small">debug values</h2>
        <pre id="debug-values" class="mono-box"></pre>
        <h2 class="panel-title-small">recent events</h2>
        <ol id="event-log" class="event-log"></ol>
      </section>

      <button id="operator-esc" class="operator-esc" type="button">Esc</button>

      <section id="operator-panel" class="operator-panel" aria-live="polite">
        <header class="operator-header">
          <h2 id="operator-title" class="operator-title">Operator</h2>
          <div class="operator-header-actions">
            <button id="operator-esc-inline" type="button" class="operator-btn">Esc</button>
            <button id="operator-restart" type="button" class="operator-btn">Restart</button>
            <button id="operator-close" type="button" class="operator-btn">Close</button>
          </div>
        </header>

        <p id="operator-status" class="operator-status">idle</p>
        <p id="operator-prompt" class="operator-prompt">No active prompt.</p>

        <div id="operator-approval-meta" class="operator-approval-meta hidden"></div>
        <div id="operator-choice-buttons" class="operator-choice-buttons"></div>

        <div class="operator-ptt-row">
          <button id="operator-ptt-ja" type="button" class="operator-btn">PTT JA</button>
          <button id="operator-ptt-en" type="button" class="operator-btn">PTT EN</button>
        </div>

        <div id="operator-text-card" class="operator-text-card">
          <input
            id="operator-text-input"
            class="operator-text-input"
            type="text"
            autocomplete="off"
            autocapitalize="none"
            spellcheck="false"
            placeholder="Text fallback input"
          />
          <div class="operator-text-actions">
            <button id="operator-text-send" type="button" class="operator-btn">Send Text</button>
            <button id="operator-text-clear" type="button" class="operator-btn">Clear</button>
            <button id="operator-text-cancel" type="button" class="operator-btn">Hide KB</button>
          </div>
        </div>

        <div class="operator-keypad">
          <button id="operator-key-up" type="button" class="operator-key-btn" aria-label="Up">↑</button>
          <button id="operator-key-enter" type="button" class="operator-key-btn">Select</button>
          <button id="operator-key-down" type="button" class="operator-key-btn" aria-label="Down">↓</button>
        </div>

        <div class="operator-mirror-row">
          <button id="operator-mirror-toggle" type="button" class="operator-btn">Terminal</button>
        </div>
        <pre id="operator-mirror" class="operator-mirror hidden" aria-label="Read only terminal mirror"></pre>
        <p id="operator-ack" class="operator-ack">ack: -</p>
      </section>

      <aside id="utterance" class="utterance hidden" aria-live="assertive"></aside>
      <div id="ui-hidden-hint" class="ui-hidden-hint hidden" aria-live="polite">UI hidden. Double tap, double click, or press Esc.</div>
      <button id="audio-replay" class="audio-replay hidden" type="button">Tap to enable audio</button>
    </main>

    <script type="importmap">
      {
        "imports": {
          "three": "https://unpkg.com/three@0.161.0/build/three.module.js"
        }
      }
    </script>
    <script type="module" src="/app.js"></script>
  </body>
</html>
